<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KuCoin Parser - Dashboard</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>ü™ô KuCoin Parser Dashboard</h1>
            <div class="header-actions">
                <button class="btn btn-primary" onclick="refreshAll()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
            </div>
        </header>

        <nav class="tabs">
            <button class="tab-btn active" onclick="showTab('coins')">–ú–æ–Ω–µ—Ç—ã</button>
            <button class="tab-btn" onclick="showTab('news')">–ù–æ–≤–æ—Å—Ç–∏</button>
            <button class="tab-btn" onclick="showTab('parsing')">–ü–∞—Ä—Å–∏–Ω–≥</button>
        </nav>

        <!-- Coins Tab -->
        <div id="coins-tab" class="tab-content active">
            <div class="section-header">
                <h2>–°–ø–∏—Å–æ–∫ –º–æ–Ω–µ—Ç</h2>
                <div class="filter-controls">
                    <label>
                        <input type="checkbox" id="filter-parsed" onchange="loadCoins()">
                        –¢–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ
                    </label>
                    <button class="btn btn-secondary" onclick="showAddCoinModal()">‚ûï –î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–µ—Ç—É</button>
                    <button class="btn btn-secondary" onclick="document.getElementById('csv-upload-input').click()">üìÅ –ó–∞–≥—Ä—É–∑–∏—Ç—å CSV</button>
                    <input type="file" id="csv-upload-input" accept=".csv" style="display: none;" onchange="uploadCoinsCSV(event)">
                </div>
            </div>
            <div class="table-container">
                <table id="coins-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                            <th>–¶–µ–Ω–∞</th>
                            <th>–ú–∞–∫—Å.</th>
                            <th>–ú–∏–Ω.</th>
                            <th>–û—Ç–∫—Ä—ã—Ç–∏–µ</th>
                            <th>–û–±—ä–µ–º</th>
                            <th>–°—Ç–∞—Ç—É—Å</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody id="coins-tbody">
                        <tr>
                            <td colspan="9" class="loading">–ó–∞–≥—Ä—É–∑–∫–∞...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <!-- Modal –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –º–æ–Ω–µ—Ç—ã -->
            <div id="add-coin-modal" class="modal" style="display: none;">
                <div class="modal-content">
                    <span class="close" onclick="closeModal('add-coin-modal')">&times;</span>
                    <h2>–î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–µ—Ç—É</h2>
                    <form id="add-coin-form" onsubmit="addCoin(event)">
                        <div class="form-group">
                            <label for="coin-name">–ù–∞–∑–≤–∞–Ω–∏–µ –º–æ–Ω–µ—Ç—ã:</label>
                            <input type="text" id="coin-name" required placeholder="BTC, ETH, SOL...">
                        </div>
                        <div class="form-group">
                            <label for="coin-price">–ù–∞—á–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):</label>
                            <input type="number" id="coin-price" step="0.00000001" value="0" min="0">
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="coin-parsed" checked>
                                –ê–∫—Ç–∏–≤–Ω–∞ –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞
                            </label>
                        </div>
                        <button type="submit" class="btn btn-primary">–î–æ–±–∞–≤–∏—Ç—å</button>
                        <button type="button" class="btn btn-secondary" onclick="closeModal('add-coin-modal')">–û—Ç–º–µ–Ω–∞</button>
                    </form>
                </div>
            </div>

            <div id="coin-details" class="modal" style="display: none;">
                <div class="modal-content">
                    <span class="close" onclick="closeModal('coin-details')">&times;</span>
                    <h2>–î–µ—Ç–∞–ª–∏ –º–æ–Ω–µ—Ç—ã</h2>
                    <div id="coin-details-content"></div>
                    <div id="timeseries-list"></div>
                </div>
            </div>
        </div>

        <!-- News Tab -->
        <div id="news-tab" class="tab-content">
            <div class="section-header">
                <h2>–ù–æ–≤–æ—Å—Ç–∏</h2>
                <div class="filter-controls">
                    <select id="news-type-filter" onchange="loadNews()">
                        <option value="">–í—Å–µ —Ç–∏–ø—ã</option>
                        <option value="news">–ù–æ–≤–æ—Å—Ç–∏</option>
                        <option value="telegram">Telegram</option>
                        <option value="url">URL</option>
                    </select>
                    <input type="number" id="news-limit" value="50" min="1" max="200" placeholder="–õ–∏–º–∏—Ç">
                    <button class="btn btn-secondary" onclick="loadNews()">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
                </div>
            </div>
            <div id="news-container" class="news-container">
                <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –Ω–æ–≤–æ—Å—Ç–µ–π...</div>
            </div>
        </div>

        <!-- Parsing Tab -->
        <div id="parsing-tab" class="tab-content">
            <div class="section-header">
                <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä—Å–∏–Ω–≥–æ–º</h2>
            </div>
            
            <div class="parsing-form">
                <h3>–ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–∞—Ä—Å–∏–Ω–≥</h3>
                <form id="parsing-form" onsubmit="startParsing(event)">
                    <div class="form-group">
                        <label for="parser-type">–¢–∏–ø –ø–∞—Ä—Å–µ—Ä–∞:</label>
                        <select id="parser-type" required>
                            <option value="kucoin_api">KuCoin API</option>
                            <option value="kucoin_driver">KuCoin Driver</option>
                            <option value="news_api">News API</option>
                            <option value="telegram_api">Telegram API</option>
                        </select>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="count">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:</label>
                            <input type="number" id="count" value="100" min="1" required>
                        </div>
                        <div class="form-group">
                            <label for="time-parser">–ò–Ω—Ç–µ—Ä–≤–∞–ª:</label>
                            <select id="time-parser">
                                <option value="1m">1 –º–∏–Ω—É—Ç–∞</option>
                                <option value="5m" selected>5 –º–∏–Ω—É—Ç</option>
                                <option value="15m">15 –º–∏–Ω—É—Ç</option>
                                <option value="1h">1 —á–∞—Å</option>
                                <option value="4h">4 —á–∞—Å–∞</option>
                                <option value="1d">1 –¥–µ–Ω—å</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="pause">–ü–∞—É–∑–∞ (–º–∏–Ω):</label>
                            <input type="number" id="pause" value="60" min="0.1" step="0.1" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="save">
                                –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
                            </label>
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="miss">
                                –ü–∞—Ä—Å–∏—Ç—å –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                            </label>
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="last-launch">
                                –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–ø—É—Å–∫
                            </label>
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="clear">
                                –û—á–∏—Å—Ç–∏—Ç—å –¥–∞—Ç–∞—Å–µ—Ç
                            </label>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="save-type">–¢–∏–ø —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:</label>
                        <select id="save-type">
                            <option value="raw">Raw</option>
                            <option value="processed">Processed</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="manual-stop" onchange="toggleCountField()">
                            –†–µ–∂–∏–º –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–æ —Ä—É—á–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ (–∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ)
                        </label>
                    </div>
                    
                    <div class="form-group">
                        <label for="coins-select">–í—ã–±—Ä–∞—Ç—å –º–æ–Ω–µ—Ç—ã (–æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º –¥–ª—è –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö):</label>
                        <div style="max-height: 200px; overflow-y: auto; border: 1px solid var(--border-color); padding: 10px; border-radius: 6px; background: var(--bg-color);">
                            <div id="coins-checklist" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 5px;">
                                <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–Ω–µ—Ç...</div>
                            </div>
                        </div>
                        <small style="color: var(--text-secondary);">–í—ã–±–µ—Ä–∏—Ç–µ –º–æ–Ω–µ—Ç—ã –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –∏–ª–∏ –æ—Å—Ç–∞–≤—å—Ç–µ –≤—Å–µ –ø—É—Å—Ç—ã–º –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –º–æ–Ω–µ—Ç</small>
                    </div>
                    
                    <button type="submit" class="btn btn-primary">‚ñ∂Ô∏è –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–∞—Ä—Å–∏–Ω–≥</button>
                </form>
            </div>

            <div class="tasks-section">
                <h3>–ê–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏</h3>
                <div id="tasks-container">
                    <div class="loading">–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–¥–∞—á</div>
                </div>
            </div>
        </div>
    </div>

    <div id="notification" class="notification"></div>

    <script src="/static/js/app.js"></script>
</body>
</html>

